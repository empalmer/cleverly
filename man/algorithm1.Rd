% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/algorithm1.R
\name{algorithm1}
\alias{algorithm1}
\title{Algorithm 1: Outer Loop for Parameter Estimation and Clustering}
\usage{
algorithm1(
  Y,
  Z,
  time,
  mi_vec,
  lp,
  cor_str,
  gammas,
  psi,
  tau,
  theta,
  C,
  d,
  nknots,
  order,
  epsilon_b,
  epsilon_r,
  epsilon_d,
  epsilon_2,
  run_min,
  max_outer_iter,
  max_admm_iter,
  max_2_iter
)
}
\arguments{
\item{Y}{An \eqn{M \times K} matrix of response variables (e.g., counts). Each column corresponds to a different response, and each row to a subject-time observation.}

\item{Z}{An \eqn{M \times (L + 1)} matrix of covariates. The first column must be a vector of 1s (intercept). If there are no external variables, \code{Z} should be a single column of 1s.}

\item{time}{A numeric vector of length \eqn{M} representing the time points associated with each row of \code{Y}.}

\item{mi_vec}{A vector of length \eqn{n} specifying the number of timepoints for each subject.}

\item{lp}{Clustering index. An integer between 0 and \eqn{L}, indicating which covariate to use for clustering. Use 0 for baseline clustering. Matches \eqn{l'} in the paper.}

\item{cor_str}{Correlation structure for the working covariance model. One of \code{"IND"}, \code{"CON"}, or \code{"AR1"}.}

\item{gammas}{A numeric vector of length \eqn{L + 1} for penalizing components of the difference matrix \code{D}.}

\item{psi}{Clustering penalty hyperparameter. Larger values encourage more pairwise similarities (i.e., more shrinkage toward common clusters).}

\item{tau}{MCP (minimax concave penalty) hyperparameter.}

\item{theta}{ADMM (alternating direction method of multipliers) hyperparameter.}

\item{C}{Constant for determining when the Hessian should be updated.}

\item{d}{Integer specifying the order of the difference matrix.}

\item{nknots}{Number of knots used in the B-spline basis.}

\item{order}{Order of the B-spline basis functions.}

\item{epsilon_b}{Convergence tolerance for Algorithm 1.}

\item{epsilon_r}{ADMM convergence tolerance for the primal residual.}

\item{epsilon_d}{ADMM convergence tolerance for the dual residual.}

\item{epsilon_2}{Convergence tolerance for Algorithm 2.}

\item{run_min}{Minimum number of runs to ensure stability (used for internal control).}

\item{max_outer_iter}{Maximum number of iterations for the outer loop (Algorithm 1).}

\item{max_admm_iter}{Maximum number of iterations for the ADMM loop (Algorithm 3).}

\item{max_2_iter}{Maximum number of iterations for the inner loop (Algorithm 2) per outer iteration.}
}
\value{
A list containing:
\describe{
\item{beta}{Estimated regression coefficients.}
\item{clusters}{Final cluster assignments.}
\item{y_hat}{Estimated fitted values.}
\item{v}{Latent variable estimates from ADMM.}
\item{admm_diffs}{History of ADMM convergence diagnostics.}
\item{admm_beta_list}{List of beta estimates from each ADMM iteration.}
\item{loop_list_beta}{List of beta estimates from each outer loop iteration.}
\item{loop_list_diff}{List of beta differences between iterations (for diagnostics).}
\item{phis_list}{List of phi estimates across iterations.}
}
}
\description{
Executes the main iterative algorithm for estimating parameters and identifying clusters based on a penalized objective function with ADMM and MCP.
}
